(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{335:function(t,e,n){"use strict";n.r(e);var r=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page-header"},[e("h4",[this._v("Notifications")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"chat-recipient-img"},[e("img",{attrs:{src:n(93),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"loader-action"},[e("span",{staticClass:"loader"})])}],o=(n(30),n(32),n(31),n(23),n(26),n(27),n(34),n(16),n(17),n(12),n(29),n(37),n(8)),c=n(9),f=n(116),l=n(118),h=n(117),d=n(272),v=n(53),m=n(15);function y(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,f=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return c=t.done,t},e:function(t){f=!0,o=t},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw o}}}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function N(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var O,w,k,C={name:"BUSINESSNOTIFICATION",components:{TOPHEADER:f.a,SIDENAV:l.a,BOTTOMNAV:h.a,PAGELOADER:d.a},data:function(){return{pageLoader:!0,accessToken:"",businessId:"",notifications:"",page:1,allNotification:0}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?N(Object(source),!0).forEach((function(e){Object(c.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):N(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({returnNotification:function(){return this.notifications}},Object(m.c)({GetBusinessData:"business/GetBusinessDetails",GetUserData:"customer/GetCustomerDetails"})),methods:{assignBusinessData:function(){var data=this.GetBusinessData;this.businessId=data.businessId;var t=this.GetUserData;this.accessToken=t.userToken},getNotification:(k=Object(o.a)(regeneratorRuntime.mark((function t(){var e,n,r,o,c,f,l,h,d,m,_,N=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=N.length>0&&void 0!==N[0]&&N[0],n={businessId:this.businessId,page:this.page},r={headers:{accessToken:this.accessToken}},t.next=5,this.$performGraphQlQuery(this.$apollo,v.k,n,r);case 5:if(1!=(o=t.sent).error){t.next=9;break}return this.$initiateNotification("error","Failed request",o.message),t.abrupt("return");case 9:if(0!=(c=o.result.data.GetBusinessNotification).success){t.next=13;break}return this.$initiateNotification("error","Failed request",c.message),t.abrupt("return");case 13:if(null==c.notification){t.next=17;break}if(!(c.notification.length>0)){t.next=17;break}if(c.notification.length>11){if(0==e)this.notifications=c.notification;else{f=y(c.notification);try{for(f.s();!(l=f.n()).done;)h=l.value,this.notifications.push(h)}catch(t){f.e(t)}finally{f.f()}}this.page=this.page+1,this.allNotification=1}else{if(0==e)this.notifications=c.notification;else{d=y(c.notification);try{for(d.s();!(m=d.n()).done;)_=m.value,this.notifications.push(_)}catch(t){d.e(t)}finally{d.f()}}this.allNotification=0}return t.abrupt("return");case 17:return this.notifications=[],t.abrupt("return");case 19:case"end":return t.stop()}}),t,this)}))),function(){return k.apply(this,arguments)}),getNotificationLink:function(t,e){return this.$businessNotificationLink(t,e)},getNotificationHeader:function(t){return this.$businessNotificationTitle(t)},markAsRead:(w=Object(o.a)(regeneratorRuntime.mark((function t(e,n,r,o,c){var f,l,h,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f=this.getNotificationLink(e,n),0!=o){t.next=9;break}return l={notificationId:r,type:"business"},h={headers:{accessToken:this.accessToken}},t.next=6,this.$performGraphQlMutation(this.$apollo,v.p,l,h);case 6:t.sent,d=this.GetBusinessData.newNotificationCount-1,this.$store.dispatch("business/setNotificationData",{newNotificationCount:d});case 9:this.$router.push(f);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e,n,r,o){return w.apply(this,arguments)}),formatNotificationTimer:function(t){return this.$timeStampModifier(t)},loadMoreNotification:(O=Object(o.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=document.getElementById("notificationLoader")).disabled=!0,t.next=5,this.getNotification(!0);case 5:e.disabled=!1;case 6:case"end":return t.stop()}}),t,this)}))),function(){return O.apply(this,arguments)})},created:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assignBusinessData(),e.next=4,t.getNotification();case 4:case"end":return e.stop()}}),e)})))()},mounted:function(){this.pageLoader=!1}},j=n(7),component=Object(j.a)(C,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"business"},[n("div",{staticClass:"body-container"},[n("TOPHEADER"),t._v(" "),n("nuxt"),t._v(" "),n("div",{staticClass:"content-container"},[n("SIDENAV"),t._v(" "),n("nuxt"),t._v(" "),n("div",{staticClass:"content-area grey-bg-color"},[t.pageLoader?n("PAGELOADER"):t._e(),t._v(" "),n("nuxt"),t._v(" "),n("div",{staticClass:"main-content"},[t._m(0),t._v(" "),n("div",{staticClass:"notification-listing-container"},[n("div",{staticClass:"chat-listing"},t._l(t.returnNotification,(function(e,r){return n("div",{key:r},[n("div",{staticClass:"chat-recipient",class:{"is-read":1==e.isRead},on:{click:function(n){return t.markAsRead(e.type,e.actionId,e.notificationId,e.isRead,n)}}},[t._m(1,!0),t._v(" "),n("div",{staticClass:"last-chat-details"},[n("div",{staticClass:"chat-time-recipient"},[n("span",[t._v(t._s(t.getNotificationHeader(e.type)))]),t._v(" "),n("span",[t._v(t._s(t.formatNotificationTimer(e.timeStamp)))])]),t._v(" "),n("div",{staticClass:"last-chat-preview"},[t._v(t._s(e.message))])])])])})),0),t._v(" "),t.allNotification?n("div",{staticClass:"load-more-action move-center mg-top-16"},[n("button",{staticClass:"btn btn-white",attrs:{id:"notificationLoader"},on:{click:function(e){return t.loadMoreNotification()}}},[t._v("\n\t\t\t\t\t\t\t\t\tLoad more notifications\n\t\t\t\t\t\t\t\t\t"),t._m(2)])]):t._e(),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.pageLoader&&!t.allNotification,expression:"!pageLoader && !allNotification"}],staticClass:"alert alert-info mg-top-16"},[t._v("\n\t\t\t\t\t\t\t\tThere is no new notification for your business\n\t\t\t\t\t\t\t")])])]),t._v(" "),n("BOTTOMNAV"),t._v(" "),n("nuxt")],1)],1)],1)])}),r,!1,null,null,null);e.default=component.exports}}]);